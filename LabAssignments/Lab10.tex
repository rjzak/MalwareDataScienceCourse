\documentclass[letter,11pt]{article}
\usepackage{hyperref}
\usepackage{graphicx}
\usepackage{fancyhdr}
\usepackage{multicol}
\pagestyle{fancy}
\usepackage[letterpaper, margin=1in]{geometry}
\geometry{letterpaper}
\usepackage{parskip} % Disable initial indent

\usepackage[utf8]{inputenc}
\fancyhf{}
\renewcommand{\headrulewidth}{0pt} % Remove default underline from header package
\rhead{CYBR/CMSC 691 - Lab 10}
%\rhead{}
\lhead{\begin{picture}(0,0) \put(0,-10){\includegraphics[width=1.1cm]{Images/UMBC-vertical}} \end{picture}}
\cfoot{\thepage}
\rfoot{\input{semester}}
\lfoot{Lab 10}
%\AtEndDocument{\vfill \hfill \LaTeX}

\begin{document}

\section*{Lab 10: Malware $N$-Grams}
\paragraph{}Provided in the VM are a variety of malware \& goodware samples. Create a program to extract $n$-grams, and make a dataset based on those ngrams. The size of $n$-grams, number of top $n$-grams to keep, should be user-selectable. This code will be used in a subsequent lab assignment.

\textbf{Points:} 40

\section*{Python Starter Code}
\small{
\begin{verbatim}
import os

def rabinHash(ngram):
  r = 0;
  for index in range(len(ngram)):
      r = (r * 227 + ord(ngram[index])) % 1000005
  return r

def ngramFromBuffer(ngramSize, buffer):
  for index in range(len(buffer)-ngramSize):
     yield buffer[index:index+ngramSize]

def findNgrams(goodDir, maldir, N, K, result):
  pass

if __name__ == `__main__':
  import sys
  if len(sys.argv) != 6:
    print("Usage: %s <GoodwareDir> <MalwareDir> <NgramSize> <TopK> <OutputFile>" %
        sys.argv[0])
    sys.exit(1)
  
  goodDir = sys.argv[1]
  malDir = sys.argv[2]
  gramSize = int(sys.argv[3])
  topK = int(sys.argv[4])
  resultFile = sys.argv[5]
  findNgrams(goodDir, malDir, gramSize, topK, resultFile)
\end{verbatim}
}
\subsection*{Hints}
\paragraph{}If you'd like, you may review code written in \href{https://www.golang.org}{Go} which does the same thing: \url{https://github.com/rjzak/gogrammer}. Creating an array of ngrams will take a lot of memory. use the hash of the ngram as the index into an array, and using the value at the array to increment a counter. Continue then using the $K$ most common $n$-grams.

Steps:
\begin{enumerate}
    \item Get contents of the directories. \texttt{os.listdir()} or \texttt{os.walk}
    \item Read each file into memory (example: \texttt{fileContents = open(filePath, "rb").read()})
    \item Get $n$-grams from the memory buffer.
    \item Hash the $n$-gram value, store into array, increment value to store counts.
    \item Sort the data based on counts, without loosing indexes (the $n$-gram values). Perhaps use a 2D array?
    \item Save the top $K$ $n$-grams.
\end{enumerate}

\section*{Questions}
\paragraph{}In a separate document, provide your answers to the following questions. The expected format is a Word document, or similar, with a few images demonstrating your progress. The assignment will be submitted via Blackboard.

\begin{itemize}
    \item How have you tested that your code works?
\end{itemize}
\end{document}