\documentclass{beamer}
\usepackage{graphicx}
\usepackage{listings} % Syntax highlighing
\usepackage{fancyvrb} % Inline verbatim
\usepackage{hyperref} % Hyperlinks
\hypersetup{pdfpagemode=FullScreen}
\usepackage{tikz}

\usepackage{bbding} % For checkmark in itemize
\newcommand*\tick{\item[\Checkmark]}
\newcommand*\fail{\item[\XSolidBrush]}

\usetheme{Boadilla}
\title{Go \includegraphics[scale=0.16]{Images/gopher.png}}
\author{UMBC Malware Data Science}
\date{Week 7: 1 March 2020}

\begin{document}

\begin{frame}
    \centering
    \Large Go! \includegraphics[]{Images/gopher.png}
\end{frame}

\begin{frame}{Go}
    Go is a system language, like C, C++; however it has a Python-inspired syntax.
   \begin{itemize}
       \item Easy slices of arrays from existing arrays. (Try doing that in C).
       \item Class-like structures (data with collection of methods).
       \item Cross-platform
       \item Robust collection of built-in modules for interacting with the user, OS, various data types; handling text, bytes, various encodings, etc.
       \item Can use system libraries directly (.dll, .so, .dylib)
   \end{itemize}
\end{frame}

\begin{frame}{Where Go Differs}
    \begin{itemize}
        \item Static typing (int, string, []byte, etc)
        \item Pointers
        \item Structure with functions instead of classes
        \item Compiles to binary, not interpreted
        \tick No GIL (Global Interpreter Lock), true threading
        \fail Unused imports \& variables are compiler errors
    \end{itemize}
\end{frame}

\begin{frame}[fragile]{Cross-Compiling}
\footnotesize
\begin{verbatim}
$ go build main.go
$ file main
main: ELF 64-bit LSB executable, x86-64, version 1 (SYSV), statically
    linked, not stripped

$ GOOS=windows GOARCH=amd64 go build -o main.exe main.go
$ file main.exe
main.exe: PE32+ executable (console) x86-64 (stripped to external PDB),
    for MS Windows
$ GOOS=windows GOARCH=386 go build -o main.exe main.go
$ file main.exe
main.exe: PE32 executable (console) Intel 80386 (stripped to external PDB),
    for MS Windows

$ GOOS=darwin GOARCH=amd64 go build main.go
$ file main
main: Mach-O 64-bit x86_64 executable

$ GOOS=linux GOARCH=arm go build main.go
$ file main
main: ELF 32-bit LSB executable, ARM, EABI5 version 1 (SYSV), statically
    linked, not stripped

\end{verbatim}
\end{frame}

\begin{frame}{Go Modules}
    \begin{center}
     \begin{tabular}{c | c | c}
        Purpose & Python & Go \\
        \hline
        Scientific applications & \href{https://www.scipy.org/}{Numpy} & \href{https://www.gonum.org/}{Gonum} \\
        Plotting, Visualizations & \href{https://matplotlib.org/}{matplotlib} & \href{https://github.com/gonum/plot}{Gonum plot} \\
        Machine Learning & \href{https://scikit-learn.org/}{sklearn} & \href{https://github.com/sjwhitworth/golearn}{Golearn}, \href{https://github.com/pa-m/sklearn}{Unofficial sklearn} \\
        DataFrames, data handling & \href{https://pandas.pydata.org/}{Pandas} & \href{https://github.com/go-gota/gota}{Gota} \\
    \end{tabular}
    \end{center}
    Extensive (not exhaustive) list of Go modules for various functionality: \url{https://github.com/avelino/awesome-go}.
\end{frame}

\begin{frame}{Why?}
    Let's go though a simple example showing how Go can be useful.
    \\ ~~ \\
    \href{https://github.com/rjzak/decompressingyara}{Decompressing Yara}: A tool for running Yara rules against files stored in compressed files.
    \\ ~~ \\
    The Ember data, which is broken into families, comes as GZip files. Yara doesn't peek inside of compressed files. Do you want to decompress everything? Some organizations may require malware to be compressed to prevent accidental execution.
    \\ ~~ \\
    Malware may be on different systems on the network, which may or may not have Yara installed, or have different versions. Do you want to install/upgrade all systems? \textit{No, you don't}.
\end{frame}

\begin{frame}[fragile]{Yara Example}
    \begin{verbatim}
rule PoisonIvy_2 {
  meta:
    author = "Kevin Breen <kevin@techanarchy.net>"
    date = "2014/04"
    ref = "http://malwareconfig.com/stats/PoisonIvy"
    maltype = "Remote Access Trojan"
    filetype = "exe"
  strings:
    $stub = {04 08 00 53 74 75 62 50 61 74 68 18 04}
    $string1 = "CONNECT %s:%i HTTP/1.0"
    $string2 = "ws2_32"
    $string3 = "cks=u"
    $string4 = "thj@h"
    $string5 = "advpack"
  condition:
    $stub at 0x1620 and all of ($string*) or (all of them)
}
        \end{verbatim}
\end{frame}

\begin{frame}{Decompressing Yara}
    Preparation has three steps:
    \begin{itemize}
        \item Install \href{https://github.com/VirusTotal/yara}{libyara} from VirusTotal, enable desired features, build a static library.
        \item Install \href{https://github.com/hillu/go-yara}{Go-Yara}, which contains Go code for interacting with libyara.
        \item Not explicitly required, but install \href{https://github.com/ulikunitz/xz}{Go-XZ}, for reading .xz LZMA-compressed files.
    \end{itemize}
    Compile:
    \begin{itemize}
        \item \texttt{go build decompressingyara.go}
        \item Run \texttt{ldd} to ensure that the static library was used.
    \end{itemize}
    Run to make sure it works: \texttt{\$ ./decompressingyara} \\
\texttt{Usage: ./decompressingyara <Directory> <Yara File>} \\
\texttt{Yara version: 3.11.0} \\
\texttt{Go version: go1.12.14}
\end{frame}

\begin{frame}{ldd}
    \only<1>{
        \texttt{ldd} is a useful tool which shows the libraries used by an executable, and if they're installed, where the system find them. \\
        \footnotesize{
            \texttt{\$ ldd decompressingyara} \\
            \texttt{	linux-vdso.so.1 (0x00007ffc0c1c3000)} \\
            \texttt{	libcrypto.so.1.1 => /usr/lib/x86\_64-linux-gnu/libcrypto.so.1.1 (0x00007fe5c7fbc000)} \\
            \texttt{	libmagic.so.1 => /usr/lib/x86\_64-linux-gnu/libmagic.so.1 (0x00007fe5c7d9a000)} \\
            \texttt{	libjansson.so.4 => /usr/lib/x86\_64-linux-gnu/libjansson.so.4 (0x00007fe5c7b8c000)} \\
            \texttt{	libm.so.6 => /lib/x86\_64-linux-gnu/libm.so.6 (0x00007fe5c77ee000)} \\
            \texttt{	libpthread.so.0 => /lib/x86\_64-linux-gnu/libpthread.so.0 (0x00007fe5c75cf000)} \\
            \texttt{	libc.so.6 => /lib/x86\_64-linux-gnu/libc.so.6 (0x00007fe5c71de000)} \\
            \texttt{	libdl.so.2 => /lib/x86\_64-linux-gnu/libdl.so.2 (0x00007fe5c6fda000)} \\
            \texttt{	libz.so.1 => /lib/x86\_64-linux-gnu/libz.so.1 (0x00007fe5c6dbd000)} \\
            \texttt{	/lib64/ld-linux-x86-64.so.2 (0x00007fe5c8487000)}
        }
    }
    \only<2>{
        Do you know what was missing? \\
        \footnotesize
        \texttt{libyara.so.3 => /usr/lib/x86\_64-linux-gnu/libyara.so.3 (0x00007febd64cb000)}
        \\ ~~ \\
        If \texttt{libyara} wasn't installed, the output would be:
        \texttt{libyara.so.3 => not found}
        \\ ~~ \\
        \begin{itemize}
            \item We don't need to statically compile in everything, such as \texttt{libmagic}, since it's rather ubiquitous.
            \item We don't want to statically compile in \texttt{libcrypto}, since \texttt{SSL} sometimes has vulnerabilities or other bugs, and we don't want to potentially drag around an old version.
            \item We could statically compile in \texttt{libjansson} if we want.
        \end{itemize}
    }
\end{frame}

\begin{frame}{Go IDEs}
    IDE = Integrated Development Environment. Code completion, syntax highlighting, code repository commands, etc, in one package.
    \\ ~~ \\
    The Go developers maintain a list of IDEs which support Go: \url{https://github.com/golang/go/wiki/IDEsAndTextEditorPlugins}.
    \\ ~~ \\
    \href{https://www.jetbrains.com/}{JetBrains}' \href{https://www.jetbrains.com/go/}{GoLand} works well, and it along with JetBrains' other products are free with your \texttt{umbc.edu} email address: \url{https://www.jetbrains.com/student/}
\end{frame}

\begin{frame}{Lab}
    No Lab, enjoy Spring Break.
\end{frame}

\end{document}